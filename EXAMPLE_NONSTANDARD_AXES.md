# GMR系统处理非标准轴线的示例

## 介绍

本示例展示了GMR（General Motion Retargeting）系统如何处理具有非标准轴线的机器人模型。在实际应用中，有些机器人可能具有不按照标准XYZ轴方向排列的关节轴线，本示例演示了如何通过配置来正确处理这类机器人。

## 文件说明

### 1. example_nonstandard_robot.urdf

这个URDF文件定义了一个具有非标准轴线的机器人模型：

- **左肩关节1**: 绕 `[0.707, 0.707, 0]` 方向旋转（45度斜轴）
- **左肩关节2**: 绕 `[0.5, 0.5, 0.707]` 方向旋转（任意方向轴线）
- **右肩关节1**: 绕 `[0.707, 0.707, 0]` 方向旋转（45度斜轴）
- **右肩关节2**: 绕 `[-0.5, -0.5, 0.707]` 方向旋转（任意方向轴线）

### 2. example_nonstandard_config.json

这个配置文件展示了如何为具有非标准轴线的机器人设置GMR配置：

- **旋转偏移四元数**: 用于补偿非标准轴线带来的坐标系差异
- **权重调整**: 针对非标准轴线调整位置和旋转权重
- **双阶段优化**: 第一阶段粗略匹配，第二阶段精细调整

## 配置要点

### 旋转偏移四元数的作用

四元数 `[qw, qx, qy, qz]` 用于处理坐标系转换，补偿由于关节轴线方向不同导致的固定角度偏差。例如：

- `[0.9239, 0.0, 0.3827, 0.0]` 表示绕Y轴旋转约45度的旋转
- `[0.8536, 0.3536, 0.3536, 0.0]` 表示复合旋转

### 权重调整策略

- **位置权重**: 对于非标准轴线，通常可以设置较低的位置权重
- **旋转权重**: 通常需要较高的旋转权重来确保方向正确
- **双阶段优化**: 第一阶段处理主要运动趋势，第二阶段进行精细调整

## 使用方法

1. 将机器人模型文件放置在 `assets/` 目录下
2. 将配置文件放置在 `general_motion_retargeting/ik_configs/` 目录下
3. 在 `general_motion_retargeting/params.py` 中注册新的机器人模型和配置

## 技术原理

GMR系统使用mink库进行逆运动学求解，mink基于MuJoCo，能够处理任意方向的关节轴线。通过雅可比矩阵，系统能够正确处理任意方向的关节轴线，并生成正确的关节角度来达到目标位置和姿态。

## 实际应用

这种配置方法适用于以下场景：

- 机器人模型中存在非标准轴线的关节
- 需要处理轴线方向与标准XYZ轴不一致的机器人
- 要求高精度姿态匹配的运动重定向任务

## 注意事项

1. 旋转偏移四元数需要通过实验或数学计算确定最佳值
2. 权重设置应根据具体应用需求进行调整
3. 对于复杂的非标准轴线配置，可能需要进行额外的调试和优化